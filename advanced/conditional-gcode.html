<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Slic3r Manual â€“ Conditional GCode</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="/style.css" type="text/css" />
</head>
<body>
<div id="back-to-website">
    <a href="http://slic3r.org/">slic3r.org &raquo;</a>
</div>
<h1 id="manual-header">
    <a href="/"><img src="/images/slic3r.png" style="float: left" /></a>
    <span>Slic3r Manual</span>
</h1>
<div style="clear: both"></div>
<div id="manual-toc">
<ul>
<li><a href="/intro/overview">Introduction</a>
<ul>
<li><a href="/intro/overview">Overview</a></li>
<li><a href="/intro/getting-support">Getting Support</a></li>
</ul></li>
<li><a href="/getting-slic3r/getting-slic3r">Getting Slic3r</a>
<ul>
<li><a href="/getting-slic3r/getting-slic3r#downloading">Downloading</a></li>
<li><a href="/getting-slic3r/getting-slic3r#installing">Installing</a></li>
<li><a href="/getting-slic3r/getting-slic3r#building-from-source">Building from source</a></li>
</ul></li>
<li><a href="/first-print/calibration">First Print</a>
<ul>
<li><a href="/first-print/calibration">Calibration</a></li>
<li><a href="/first-print/configuration-wizard">Configuration Wizard</a></li>
<li><a href="/first-print/first-layer">The Important First Layer</a></li>
<li><a href="/first-print/working-with-models">Working with Models</a></li>
<li><a href="/first-print/printing">Printing</a></li>
</ul></li>
<li>Print Configurations
<ul>
<li><a href="/expert-mode/print-settings">Print Settings</a></li>
<li><a href="/expert-mode/filament-settings">Filament Settings</a></li>
<li><a href="/expert-mode/printer-settings">Printer Settings</a></li>
<li><a href="/expert-mode/print-settings#speed">Speed</a></li>
<li><a href="/expert-mode/print-settings#infill-patterns">Infill Patterns and Density</a></li>
<li><a href="/expert-mode/print-settings#infill-optimization">Infill Optimization</a></li>
<li><a href="/expert-mode/fighting-ooze">Fighting Ooze</a></li>
<li><a href="/expert-mode/print-settings#skirt-and-brim">Skirt and brim</a></li>
<li><a href="/expert-mode/cooling">Cooling</a></li>
<li><a href="/expert-mode/print-settings#support-material">Support Material</a></li>
<li><a href="/expert-mode/print-settings#extrusion-width">Extrusion Width</a></li>
<li><a href="/advanced/sequential-printing">Sequential Printing</a></li>
<li><a href="/expert-mode/variable-layer-height">Variable Layer Height</a></li>
<li><a href="/configuration-organization/configuration-organization">Profiles and configuration</a></li>
</ul></li>
<li>Input/output files
<ul>
<li><a href="/advanced/repairing-models">Repairing Models</a></li>
<li><a href="/advanced/svg-output">SVG Output</a></li>
</ul></li>
<li>Topics
<ul>
<li><a href="/expert-mode/multiple-extruders">Multiple Extruders</a></li>
<li><a href="/topics/draft-quality">Draft Quality</a></li>
<li><a href="/topics/supported-file-formats">3D Model File Format Overview</a></li>
</ul></li>
<li>GUI
<ul>
<li><a href="/advanced/plater">3D Plater/Preview</a></li>
</ul></li>
<li>Advanced Topics
<ul>
<li><a href="/advanced/command-line">Command Line Usage</a></li>
<li><a href="/advanced/post-processing">Post-Processing Scripts</a></li>
<li><a href="/advanced/conditional-gcode">Conditional G-Code</a></li>
<li><a href="/advanced/placeholder-parser">Custom GCode Placeholders</a></li>
<li><a href="/advanced/flow-math">Flow Math</a></li>
<li><a href="/advanced/modifier-mesh">Modifier Meshes</a></li>
<li><a href="/advanced/filament-swaps">Filament Swaps</a></li>
</ul></li>
<li>Troubleshooting
<ul>
<li><a href="/troubleshooting/dimension-errors">Dimension Errors</a></li>
<li><a href="/troubleshooting/troubleshooting#z-wobble">Z Wobble</a></li>
</ul></li>
<li>Internals Documentation (Doxygen)
<ul>
<li><a href="/libslic3r-doc">libslic3r</a></li>
</ul></li>
</ul>
</div>
<div id="manual-body">
<div id="header">
<h1 class="title">Conditional GCode</h1>
</div>
<h1 id="overview">Overview</h1>
<p>Conditional G-code is a powerful feature of Slic3r that allows for arbitrary math to be done in Custom G-code fields as well as setting conditions for specific statements to appear in output from Custom G-code.</p>
<h1 id="conditional-expressions">Conditional expressions</h1>
<p>Conditional expressions has the following syntax:</p>
<ul>
<li><code>{if _expression_}</code></li>
</ul>
<p><em>expression</em> may take one of the following forms:</p>
<ul>
<li><em>VARIABLE</em> <em>OPERATOR</em> <em>CONSTANT</em></li>
<li><em>CONSTANT</em> <em>OPERATOR</em> <em>VARIABLE</em></li>
<li><code>{_subexpression_}</code> <em>OPERATOR</em> <code>{_subexpression_}</code></li>
<li><em>OPERATOR</em> <code>_subexpression_</code></li>
</ul>
<p><em>subexpression</em> has the same forms as <em>expression</em>.</p>
<p>If _subexpression_s exist, they are evaluated before any other operators.</p>
<p>Available operators:</p>
<ul>
<li><code>&amp;&amp;</code> or <code>and</code>: logical AND</li>
<li><code>||</code> or <code>or</code>: logical OR</li>
<li><code>!</code> or <code>not</code>: logical NOT (inversion)</li>
<li><code>^</code> or <code>xor</code>: XOR (exclusive-OR)</li>
<li><code>==</code> or <code>equals</code>: equality comparison</li>
<li><code>!=</code>: inequality comparison. To use words, use a subexpression.</li>
<li><code>&lt;</code>: less than (valid for numbers only)</li>
<li><code>&lt;=</code>: less than or equal to (valid for numbers only)</li>
<li><code>&gt;</code>: greater than (valid for numbers only)</li>
<li><code>&gt;=</code>: greater than or equal to (valid for numbers only)</li>
<li>Anything supported by <a href="http://www.partow.net/programming/exprtk/index.html">exprtk</a> (except for generic variables, file I/O and expressions that involve <code>{}</code>)</li>
</ul>
<p>The <code>true</code> and <code>false</code> keywords are available.</p>
<p>To apply a single condition to multiple lines, repeat it once for each line:</p>
<pre><code>{if [layer_num] == 10}M104 S210
{if [layer_num] == 10}M600</code></pre>
<p>If a conditional expression evaluates to false, all the characters until the end of the line are removed. If a conditional expression fails to parse, it's silently left untouched.</p>
<p>Expressions may be chained for an implicit AND:</p>
<pre><code>{if [layer_num] == 10}{if [temperature_1] != 210}M104 S210</code></pre>
<h2 id="conventions">Conventions</h2>
<ul>
<li>Numerical value of 0 is equivalent to logical <code>false</code>. Any nonzero value is considered to be logical <code>true</code>.
<ul>
<li><code>{if { 1 - 1 } }</code> would result in 0 and thus <code>false</code>.</li>
</ul></li>
</ul>
<h1 id="value-expressions-g-code-math">Value expressions (G-code Math)</h1>
<p>Any expression enclosed in two curly brackets, but not starting with <code>{if</code> is evaluated as an arithmetic expression: <code>{foo - bar}</code>. If evaluation fails, the expression is silently left untouched. If any float variables are used, return value will have decimals. If string variables are mixed with numeric variables, they are parsed as floats if they have a dot, or integers otherwise.</p>
<p>Value expressions can be used in conditional expressions by nesting them: <code>{if {foo - bar} &gt; 10}</code>.</p>
<ul>
<li>All operators supported for conditional expressions are supported for value expressions.</li>
</ul>
<h1 id="restrictions">Restrictions</h1>
<ul>
<li>Every expression in <code>{}</code> must resolve to a number.</li>
<li>Nested sub-expressions are evaluated before the current expression is evaluated.</li>
<li>Value Expressions and Conditional G-code are evaluated before any post-processing scripts.</li>
</ul>
<h1 id="troubleshooting">Troubleshooting</h1>
<ul>
<li>If the parser can't understand your statements, it will output nothing for that block.</li>
<li>Remember that Custom G-code placeholders (items in <code>[]</code>) are resolved before Conditional G-code.</li>
</ul>
</div>
<div id="manual-footer">
    Written by <a href="http://garyhodgson.com/">Gary Hodgson</a> with contributions from Alessandro Ranellucci and Jeff Moe<br />
    Sponsored by <a href="http://lulzbot.com/">LulzBot</a> - &copy; Aleph Objects, Inc.<br />
    Permission is granted to copy, distribute and/or modify this document under the terms of the 
    <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons BY-SA 3.0 license</a>
</div>
</body>
</html>
